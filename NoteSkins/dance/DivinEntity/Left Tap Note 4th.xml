<ActorFrame InitCommand="%function(self)				
				DIVINE_ENTITY = {tapArrows={}, ghostArrows={}}

				function DIVINE_ENTITY:registerTapArrow (name, actor)
					self.tapArrows[name] = actor
				end

				function DIVINE_ENTITY:getTapArrows(direction, quant)
					direction = direction or ''
					quant = quant or ''
					
					local function catch(table, key)
					    return function(...)
							local paramsToPassOn = {}
						
							tick = 1;
							for i,v in pairs(arg) do
							    if type(v) ~= 'table' then
									paramsToPassOn[tick] = v
									tick = tick+1
								end
							end
						 
							for i,v in pairs(arg[1]) do
								--SCREENMAN:SystemMessage(tostring(i))
							    --This is the worst hack ever and I am not proud of it.
								_G['DivinEntity_f2r'] = v
								funcstr = '_G[\'DivinEntity_f2r\']:' .. key .. '(\'' .. unpack(paramsToPassOn) .. '\')';
								assert(loadstring(funcstr))()
							end
						end
					end
					
					local arrows = {}
					local mt = { __index = catch }

					setmetatable(arrows, mt)

					--No string.match in Lua 5.0 :[
					for name,actor in pairs(self.tapArrows) do
						if direction and quant then
							if string.find(name, direction .. ' Tap Note ' .. quant) then arrows[name] = actor end
						elseif direction then
							if string.find(name, direction) then arrows[name] = actor end
						elseif quant then
							if string.find(name, quant) then arrows[name] = actor end 
						else
							arrows[name] = actor
						end
					end	

					return arrows
				end
			end">
<children>

<Actor
	File='sprites/4th.sprite'
	InitCommand='%function (self)
		DIVINE_ENTITY:registerTapArrow("Left Tap Note 4th", self)
		self:rotationz(90);
	end'
/>
</children></ActorFrame>
